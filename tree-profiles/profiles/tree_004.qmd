---
title: "**Autumn Brilliance Serviceberry**"
description: "Tree ID: 004"
image: "all_tree_images/004/main.jpg"
---

<br>

Planted By: D. Hayes, E. Nagao, K. VonBehren, T. Lister

```{r}
#| error: false
#| echo: false
#| message: false
#| warning: false
my_tree <- '004'
library(tidyverse)
library(sf)
library(knitr)

tree_shp <- st_read("all_tree_images/coe_tree_archive.shp", quiet = TRUE)

df <- st_drop_geometry(tree_shp) %>% 
  filter(str_pad(ID, width = 3, side = "left", pad = "0") == my_tree) %>% 
  select(
    plant, dbh, rep_val, c_stor_1, gr_c_1, runoff_1, poll_1
  ) %>% 
  pivot_longer(cols = 2:7, values_to = 'i-Tree Eco Estimate', names_to = 'Variable')

df$Variable <- c(
  'Diameter at Breast Height (inches)',
  'Replacement Value ($)',
  'Carbon Storage (lbs)',
  'Gross Carbon Removal (lbs/year)',
  'Avoided Runoff (ft<sup>3</sup>/year)',
  'Air Pollution Removal (oz/year)'
)

df0 <- df[1,]
colnames(df0) <- c('Measurement Date', 'Variable', 'Measured Value')

df1 <- df[2:6,]
colnames(df1) <- c('Measurement Date', 'Variable', 'i-Tree Eco Estimated Value')
```

## **Size Measurements**

```{r}
#| error: false
#| echo: false
#| message: false
#| warning: false
#| tbl-colwidths: [30,40,30]
kable(df0)
```

## **i-Tree Eco Estimates**

```{r}
#| error: false
#| echo: false
#| message: false
#| warning: false
#| tbl-colwidths: [30,40,30]
kable(df1)
```

[Read more about these estimates](https://www.itreetools.org/support/resources-overview/i-tree-methods-and-files).

## **Location**

Latitude, Longitude: 41.9866661393665, -91.6562904132506

```{r}
#| error: false
#| echo: false
#| message: false
#| warning: false
my_tree <- '004'
# Importing packages
library(tidyverse)
library(sf)
library(tmap)
library(leaflet)
library(leaflet.extras)

# Remove scientific notation
options(scipen = 999)

#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
## Formatting Set Up -----------------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

tree_shp <- st_read("all_tree_images/coe_tree_archive.shp", quiet = TRUE) 

# Formatting the names of planters
format_names <- function(x){
  if(is.na(x)){
    output = "Unknown"
  } else {
    output = str_replace_all(x, pattern = ", ", replacement="<br>")
    output = paste("<br>", output, sep="")
  }
  return(output)
}

# Setting up the tree icons
treeIcons <- iconList(
  Oak = makeIcon(
    iconUrl = "all_tree_images/tree_icons/oak.png",
    iconWidth = 25, iconHeight = 50
  ),
  Maple = makeIcon(
    iconUrl = "all_tree_images/tree_icons/maple.png",
    iconWidth = 25, iconHeight = 50
  ),
  `Honey Locust` = makeIcon(
    iconUrl = "all_tree_images/tree_icons/honeylocust.png",
    iconWidth = 25, iconHeight = 50
  ),
  Elm = makeIcon(
    iconUrl = "all_tree_images/tree_icons/elm.png",
    iconWidth = 25, iconHeight = 50
  ),
  Ash = makeIcon(
    iconUrl = "all_tree_images/tree_icons/ash.png",
    iconWidth = 25, iconHeight = 50
  ),
  Evergreen = makeIcon(
    iconUrl = "all_tree_images/tree_icons/evergreen.png",
    iconWidth = 25, iconHeight = 50
  ),
  Crabapple = makeIcon(
    iconUrl = "all_tree_images/tree_icons/crabapple.png",
    iconWidth = 25, iconHeight = 50
  ),
  Other = makeIcon(
    iconUrl = "all_tree_images/tree_icons/other.png",
    iconWidth = 25, iconHeight = 50
  )
)

# Processing

tree_shp  <- tree_shp %>% 
  rowwise %>% 
  mutate(
    formatted_names = format_names(planters),
    ID = str_pad(ID, width = 3, side="left", pad="0")
  )

#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# The Map ----------------------------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

mini_map <- tree_shp %>% filter(ID == my_tree)
my_coords <- st_coordinates(mini_map)

leaflet(mini_map, 
        options = leafletOptions(minZoom = 15, maxZoom = 20, maxNativeZoom=20)) %>%
  addMarkers(
    icon = ~treeIcons[tree_grp], 
    popup = ~paste(
      '<h3>',species,"</h3>",
      "<hr> </hr>",
      "<table>
        <tr>
        <th>Tree ID#:</th>
        <th>", ID, "</th>
        </tr>",
      "<tr>
        <td>Diameter:</td>
        <td>", dbh, "in.</td>
        </tr>",
      "<tr>
        <td>Carbon Sequestration: &nbsp; &nbsp; &nbsp;</td>
        <td>", c_stor_1, "lbs</td>
        </tr>",
      "<tr>
        <td>Avoided Runoff:</td>
        <td>", runoff_1, "ft.<sup>3</sup>/yr</td>
        </tr>",
      "<tr>
        <td>Air Pollution Removal:</td>
        <td>", poll_1, "oz/yr</td>
        </tr>",
      "<tr>
        <td>Planted By:</td>
        <td>", formatted_names, "</td>
        </tr>",
      "</table>"
    )
  ) %>% 
  addResetMapButton() %>%
  addFullscreenControl()%>% 
  addProviderTiles(providers$OpenStreetMap.France) %>% 
  setView(lat = my_coords[2], lng = my_coords[1], zoom = 18)

```

## **Images**

![This special tree was planted as a part of the inauguration of Coe College's 16th president, David Hayes. From left to right, President David Hayes ('91), Enzo Nagao ('20) of Trees Forever, Kent VonBehren ('91) of Trees Forever, and Student Body President Toby Lister ('24), all plant the Autumn Brilliance Serviceberry on the morning of October 1, 2022.](all_tree_images/004/main.jpg)

::: column-margin
<center><a class="button" href="https://forms.gle/W6f5nwYxrM33hF4f7">Notice a Mistake?</a></center>
:::
